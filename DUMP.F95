!
!**********************************************************************C
!**********************************************************************C
!**********************************************************************C
!
       SUBROUTINE DUMP
!
! **  THIS SUBROUTINE IS PART OF  EFDC-FULL VERSION 1.0a
!
! **  LAST MODIFIED BY JOHN HAMRICK ON 1 NOVEMBER 2001
!
!----------------------------------------------------------------------C
!
! CHANGE RECORD
! DATE MODIFIED     BY                 DATE APPROVED    BY
!
!----------------------------------------------------------------------C
!
! **  SUBROUTINE DUMP WRITES FULL FIELD DUMPS OF MODEL VARIABLES
! **  AT SPECIFIED TIME INTERVALS
!
!**********************************************************************C
!
      INCLUDE 'EFDC.PAR'
      INCLUDE 'EFDC.CMN'
!
!**********************************************************************C
!
!      DIMENSION P(LCM),SEDBT(LCM),SNDBT(LCM),VOLBW2(LCM),
!     &          TOXB(LCM,NTXM),TOXPFTB(LCM,NTXM),U(LCM,KCM),
!     &          V(LCM,KCM),W(LCM,KCM),SAL(LCM,KCM),TEM(LCM,KCM),
!     &          DYE(LCM,KCM),SEDT(LCM,KCM),
!     &          SNDT(LCM,KCM),TOX(LCM,KCM,NTXM),
!     &          TOXPFTW(LCM,KCM,NTXM),LNC(LCM),ISTRAN(7)
!
!      CHARACTER*13 FNDSEL,FNDUUU,FNDVVV,FNDWWW,FNDSAL,FNDTEM,FNDDYE,
!     &          FNDSDW,FNDSDB,FNDSNW,FNDSNB,FNDBDH,FNDTXW(NTXM),
!     &          FNDTXB(NTXM),FNDTPW(NTXM),FNDTPB(NTXM)
!
!**********************************************************************C
!
      DIMENSION TXWMAX(NTXM),TXWMIN(NTXM),TXBMAX(NTXM),TXBMIN(NTXM)
      DIMENSION DMPVALL(LCM-2),DMPVAL(LCM-2,KCM),DMPVALB(LCM-2,KBM)
      DIMENSION IDMPVALL(LCM-2),IDMPVAL(LCM-2,KCM)
!      INTEGER*1 IB08VALL(LCM-2),IB08VAL(LCM-2,KCM)
!      INTEGER*2 IB16VALL(LCM-2),IB16VAL(LCM-2,KCM)
      DIMENSION IB08VALL(LCM-2),IB08VAL(LCM-2,KCM)
      DIMENSION IB16VALL(LCM-2),IB16VAL(LCM-2,KCM)
      CHARACTER*1 CZTT(0:9)
      CHARACTER*1 CCHTMF,CCHTMS
      CHARACTER*2 CNTTOX(NTXM)
!
!**********************************************************************C
!
! **  INFORMATION FOR TESTING AS STAND ALONE PROGRAM
!
!      LC=514
!      LA=LC-1
!      KC=10
!      NTOX=20
!
!      DO L=1,LC
!       P(L)=FLOAT(L-1)
!       SEDBT(L)=FLOAT(L-1)
!       SNDBT(L)=FLOAT(L-1)
!      ENDDO
!      DO K=1,KC
!       DO L=1,LC
!        U(L,K)=FLOAT(L-1)
!        V(L,K)=FLOAT(L-1)
!        W(L,K)=FLOAT(L-1)
!        SAL(L,K)=FLOAT(L-1)
!        TEM(L,K)=FLOAT(L-1)
!        DYE(L,K)=FLOAT(L-1)
!        SEDT(L,K)=FLOAT(L-1)
!        SNDT(L,K)=FLOAT(L-1)
!       ENDDO
!      ENDDO
!
!      DO NT=1,NTOX
!      DO L=1,LC
!       TOXB(L,KB,NT)=FLOAT(L-1)
!       TOXPFTB(L,NT)=FLOAT(L-1)/512.
!      ENDDO
!      DO K=1,KC
!       DO L=1,LC
!        TOX(L,K,NT)=FLOAT(L-1)
!        TOXPFTW(L,K,NT)=FLOAT(L-1)/512.
!       ENDDO
!      ENDDO
!      ENDDO
!
!      JSDUMP=1
!      ISDUMP=2
!      ISADMP=0
!      NSDUMP=1
!      TSDUMP=1.
!      TEDUMP=1.
!      ISDMPP=1
!      ISDMPU=1
!      ISDMPW=1
!      ISDMPT=1
!      IADJDMP=-32768
!      NTOX=20
!
!      DO N=1,7
!       ISTRAN(N)=1
!      ENDDO
!
!      GI=1./9.8
!
!      DT=1.
!      TCON=1
!      TBEGIN=0.
!      N=1
!
!**********************************************************************C
!
      IF(JSDUMP.NE.1) GOTO 300
!
!----------------------------------------------------------------------C
!
      CZTT(0)='0'
      CZTT(1)='1'
      CZTT(2)='2'
      CZTT(3)='3'
      CZTT(4)='4'
      CZTT(5)='5'
      CZTT(6)='6'
      CZTT(7)='7'
      CZTT(8)='8'
      CZTT(9)='9'
!
      DO MLTM=1,NTOX
      MSDIG=MOD(MLTM,10)
      MTMP=MLTM-MSDIG
      MFDIG=MTMP/10
      CCHTMF=CZTT(MFDIG)
      CCHTMS=CZTT(MSDIG)
      CNTTOX(MLTM)= CCHTMF // CCHTMS
      ENDDO
!
!  ISDUMP=1, ASCII INTERGER OUTPUT
!
      IF(ISDUMP.EQ.1)THEN
      FNDSEL='SELDMPI.ASC'
      FNDUUU='UUUDMPI.ASC'
      FNDVVV='VVVDMPI.ASC'
      FNDWWW='WWWDMPI.ASC'
      FNDSAL='SALDMPI.ASC'
      FNDTEM='TEMDMPI.ASC'
      FNDDYE='DYEDMPI.ASC'
      FNDSDW='SDWDMPI.ASC'
      FNDSDB='SDBDMPI.ASC'
      FNDSNW='SNWDMPI.ASC'
      FNDSNB='SNBDMPI.ASC'
      FNDBDH='BDHDMPI.ASC'
      DO NT=1,NTOX
       FNDTWT(NT)='TWT'// CNTTOX(NT) // 'DPI.ASC'
       FNDTWF(NT)='TWF'// CNTTOX(NT) // 'DPI.ASC'
       FNDTWC(NT)='TWC'// CNTTOX(NT) // 'DPI.ASC'
       FNDTWP(NT)='TWP'// CNTTOX(NT) // 'DPI.ASC'
       FNDTBT(NT)='TBT'// CNTTOX(NT) // 'DPI.ASC'
       FNDTBF(NT)='TBF'// CNTTOX(NT) // 'DPI.ASC'
       FNDTBC(NT)='TBC'// CNTTOX(NT) // 'DPI.ASC'
       FNDTBP(NT)='TBP'// CNTTOX(NT) // 'DPI.ASC'
      ENDDO
      ENDIF
!
!  ISDUMP=2, 16/8 BIT BINARY INTERGER OUTPUT
!
      IF(ISDUMP.EQ.2)THEN
      FNDSEL='SELDMPI.BIN'
      FNDUUU='UUUDMPI.BIN'
      FNDVVV='VVVDMPI.BIN'
      FNDWWW='WWWDMPI.BIN'
      FNDSAL='SALDMPI.BIN'
      FNDTEM='TEMDMPI.BIN'
      FNDDYE='DYEDMPI.BIN'
      FNDSDW='SDWDMPI.BIN'
      FNDSDB='SDBDMPI.BIN'
      FNDSNW='SNWDMPI.BIN'
      FNDSNB='SNBDMPI.BIN'
      FNDBDH='BDHDMPI.BIN'
      DO NT=1,NTOX
       FNDTWT(NT)='TWT'// CNTTOX(NT) // 'DPI.BIN'
       FNDTWF(NT)='TWF'// CNTTOX(NT) // 'DPI.BIN'
       FNDTWC(NT)='TWC'// CNTTOX(NT) // 'DPI.BIN'
       FNDTWP(NT)='TWP'// CNTTOX(NT) // 'DPI.BIN'
       FNDTBT(NT)='TBT'// CNTTOX(NT) // 'DPI.BIN'
       FNDTBF(NT)='TBF'// CNTTOX(NT) // 'DPI.BIN'
       FNDTBC(NT)='TBC'// CNTTOX(NT) // 'DPI.BIN'
       FNDTBP(NT)='TBP'// CNTTOX(NT) // 'DPI.BIN'
      ENDDO
      ENDIF
!
!  ISDUMP=3, ASCII FLOATING POINT OUTPUT
!
      IF(ISDUMP.EQ.3)THEN
      FNDSEL='SELDMPF.ASC'
      FNDUUU='UUUDMPF.ASC'
      FNDVVV='VVVDMPF.ASC'
      FNDWWW='WWWDMPF.ASC'
      FNDSAL='SALDMPF.ASC'
      FNDTEM='TEMDMPF.ASC'
      FNDDYE='DYEDMPF.ASC'
      FNDSDW='SDWDMPF.ASC'
      FNDSDB='SDBDMPF.ASC'
      FNDSNW='SNWDMPF.ASC'
      FNDSNB='SNBDMPF.ASC'
      FNDBDH='BDHDMPF.ASC'
      DO NT=1,NTOX
       FNDTWT(NT)='TWT'// CNTTOX(NT) // 'DPF.ASC'
       FNDTWF(NT)='TWF'// CNTTOX(NT) // 'DPF.ASC'
       FNDTWC(NT)='TWC'// CNTTOX(NT) // 'DPF.ASC'
       FNDTWP(NT)='TWP'// CNTTOX(NT) // 'DPF.ASC'
       FNDTBT(NT)='TBT'// CNTTOX(NT) // 'DPF.ASC'
       FNDTBF(NT)='TBF'// CNTTOX(NT) // 'DPF.ASC'
       FNDTBC(NT)='TBC'// CNTTOX(NT) // 'DPF.ASC'
       FNDTBP(NT)='TBP'// CNTTOX(NT) // 'DPF.ASC'
      ENDDO
      ENDIF
!
!  ISDUMP=4, 32/64 BIT BINARY FLOATING POINT OUTPUT
!
      IF(ISDUMP.EQ.4)THEN
      FNDSEL='SELDMPF.BIN'
      FNDUUU='UUUDMPF.BIN'
      FNDVVV='VVVDMPF.BIN'
      FNDWWW='WWWDMPF.BIN'
      FNDSAL='SALDMPF.BIN'
      FNDTEM='TEMDMPF.BIN'
      FNDDYE='DYEDMPF.BIN'
      FNDSDW='SDWDMPF.BIN'
      FNDSDB='SDBDMPF.BIN'
      FNDSNW='SNWDMPF.BIN'
      FNDSNB='SNBDMPF.BIN'
      FNDBDH='BDHDMPF.BIN'
      DO NT=1,NTOX
       FNDTWT(NT)='TWT'// CNTTOX(NT) // 'DPF.BIN'
       FNDTWF(NT)='TWF'// CNTTOX(NT) // 'DPF.BIN'
       FNDTWC(NT)='TWC'// CNTTOX(NT) // 'DPF.BIN'
       FNDTWP(NT)='TWP'// CNTTOX(NT) // 'DPF.BIN'
       FNDTBT(NT)='TBT'// CNTTOX(NT) // 'DPF.BIN'
       FNDTBF(NT)='TBF'// CNTTOX(NT) // 'DPF.BIN'
       FNDTBC(NT)='TBC'// CNTTOX(NT) // 'DPF.BIN'
       FNDTBP(NT)='TBP'// CNTTOX(NT) // 'DPF.BIN'
      ENDDO
      ENDIF
!
      IF(ISADMP.EQ.0)THEN
!
        OPEN(1,FILE=FNDSEL)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDUUU)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDVVV)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDWWW)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDSAL)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDTEM)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDDYE)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDSDW)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDSDB)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDSNW)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDSNB)
        CLOSE(1,STATUS='DELETE')
!
        OPEN(1,FILE=FNDBDH)
        CLOSE(1,STATUS='DELETE')
!
        DO NT=1,NTOX
         OPEN(1,FILE=FNDTWT(NT))
         CLOSE(1,STATUS='DELETE')
         OPEN(1,FILE=FNDTWF(NT))
         CLOSE(1,STATUS='DELETE')
         OPEN(1,FILE=FNDTWC(NT))
         CLOSE(1,STATUS='DELETE')
         OPEN(1,FILE=FNDTWP(NT))
         CLOSE(1,STATUS='DELETE')
         OPEN(1,FILE=FNDTBT(NT))
         CLOSE(1,STATUS='DELETE')
         OPEN(1,FILE=FNDTBF(NT))
         CLOSE(1,STATUS='DELETE')
         OPEN(1,FILE=FNDTBC(NT))
         CLOSE(1,STATUS='DELETE')
         OPEN(1,FILE=FNDTBP(NT))
         CLOSE(1,STATUS='DELETE')
        ENDDO
!
      ENDIF
!
      JSDUMP=0
!
!**********************************************************************C
!
  300 CONTINUE
!
!----------------------------------------------------------------------C
!
      DO K=1,KC
       DO L=1,LC-2
        DMPVAL(L,K)=0.
        IDMPVAL(L,K)=0
        IB08VAL(L,K)=0
        IB16VAL(L,K)=0
       ENDDO
      ENDDO
!
      DO L=1,LC-2
       DMPVALL(L)=0.
       IDMPVALL(L)=0
       IB08VALL(L)=0
       IB16VALL(L)=0
      ENDDO
!
      IF(ISDYNSTP.EQ.0)THEN
        TIME=(DT*FLOAT(N)+TCON*TBEGIN)/86400.
      ELSE
        TIME=TIMESEC/86400.
      ENDIF
      R1=1.
      R0=0.
!
!**********************************************************************C
!
! **  IF(ISDUMP EQUAL 1 OR 2, SCALE VARIABLES AND WRITE INTEGER
! **  DUMP FILES
!
      IF(ISDUMP.LE.2)THEN
!
! **  SCALE VARIABLES
!
      SELMAX=-1.E12
      SELMIN=1.E12
      UUUMAX=-1.E12
      UUUMIN=1.E12
      VVVMAX=-1.E12
      VVVMIN=1.E12
      WWWMAX=-1.E12
      WWWMIN=1.E12
      SALMAX=-1.E12
      SALMIN=1.E12
      TEMMAX=-1.E12
      TEMMIN=1.E12
      DYEMAX=-1.E12
      DYEMIN=1.E12
      SDWMAX=-1.E12
      SDWMIN=1.E12
      SDBMAX=-1.E12
      SDBMIN=1.E12
      SNWMAX=-1.E12
      SNWMIN=1.E12
      SNWMAX=-1.E12
      SNWMIN=1.E12
      SNBMAX=-1.E12
      SNBMIN=1.E12
      BDHMAX=-1.E12
      BDHMIN=1.E12
      DO NT=1,NTOX
       TXWMAX(NT)=-1.E12
       TXWMIN(NT)=1.E12
       TXBMAX(NT)=-1.E12
       TXBMIN(NT)=1.E12
      ENDDO
!
      IF(ISDMPP.GE.1)THEN
        DO L=2,LA
         SELMAX=MAX(SELMAX,P(L))
         SELMIN=MIN(SELMIN,P(L))
        ENDDO
      ENDIF
      SELMAX=GI*SELMAX
      SELMIN=GI*SELMIN
!
      IF(ISDMPU.GE.1)THEN
        DO K=1,KC
        DO L=2,LA
         UTMP=0.5*(U(L,K)+U(L+1,K))
         VTMP=0.5*(V(L,K)+V(LNC(L),K))
         UUUMAX=MAX(UUUMAX,UTMP)
         UUUMIN=MIN(UUUMIN,UTMP)
         VVVMAX=MAX(VVVMAX,UTMP)
         VVVMIN=MIN(VVVMIN,VTMP)
        ENDDO
        ENDDO
      ENDIF
!
      IF(ISDMPW.GE.1)THEN
        DO K=1,KC
        DO L=2,LA
         WTMP=0.5*(W(L,K)+W(L,K-1))
         WWWMAX=MAX(WWWMAX,WTMP)
         WWWMIN=MIN(WWWMIN,WTMP)
        ENDDO
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(1).GE.1)THEN
        DO K=1,KC
        DO L=2,LA
         SALMAX=MAX(SALMAX,SAL(L,K))
         SALMIN=MIN(SALMIN,SAL(L,K))
        ENDDO
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(2).GE.1)THEN
        DO K=1,KC
        DO L=2,LA
         TEMMAX=MAX(TEMMAX,TEM(L,K))
         TEMMIN=MIN(TEMMIN,TEM(L,K))
        ENDDO
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(3).GE.1)THEN
        DO K=1,KC
        DO L=2,LA
         DYEMAX=MAX(DYEMAX,DYE(L,K))
         DYEMIN=MIN(DYEMIN,DYE(L,K))
        ENDDO
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(6).GE.1)THEN
        DO K=1,KC
        DO L=2,LA
         SDWMAX=MAX(SDWMAX,SEDT(L,K))
         SDWMIN=MIN(SDWMIN,SEDT(L,K))
        ENDDO
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(7).GE.1)THEN
        DO K=1,KC
        DO L=2,LA
         SNWMAX=MAX(SNWMAX,SNDT(L,K))
         SNWMIN=MIN(SNWMIN,SNDT(L,K))
        ENDDO
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(5).GE.1)THEN
        DO NT=1,NTOX
        DO K=1,KC
        DO L=2,LA
         TXWMAX(NT)=MAX(TXWMAX(NT),TOX(L,K,NT))
         TXWMIN(NT)=MIN(TXWMIN(NT),TOX(L,K,NT))
        ENDDO
        ENDDO
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(6).GE.1)THEN
        DO L=2,LA
         SDBMAX=MAX(SDBMAX,SEDBT(L,KBT(L)))
         SDBMIN=MIN(SDBMIN,SEDBT(L,KBT(L)))
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(7).GE.1)THEN
        DO L=2,LA
         SNBMAX=MAX(SNBMAX,SNDBT(L,KBT(L)))
         SNBMIN=MIN(SNBMIN,SNDBT(L,KBT(L)))
        ENDDO
      ENDIF
!
      IF(ISDMPT.GE.1)THEN
      IF(ISTRAN(7).GE.1.OR.ISTRAN(6).GE.1)THEN
        DO L=2,LA
         BDHMAX=MAX(BDHMAX,VOLBW2(L,KBT(L)))
         BDHMIN=MIN(BDHMIN,VOLBW2(L,KBT(L)))
        ENDDO
      ENDIF
      ENDIF
!
      IF(ISDMPT.GE.1.AND.ISTRAN(5).GE.1)THEN
        DO NT=1,NTOX
        DO L=2,LA
         TXBMAX(NT)=MAX(TXBMAX(NT),TOXB(L,KBT(L),NT))
         TXBMIN(NT)=MIN(TXBMIN(NT),TOXB(L,KBT(L),NT))
        ENDDO
        ENDDO
      ENDIF
!
! **  WRITE ARRAYS
!
      IF(ISDUMP.EQ.1) RSCALE=65535.
      IF(ISDUMP.EQ.2) RSCALE=65535.
!
! **  WATER SURFACE ELEVATION
!
      IF(ISDMPP.GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDSEL,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDSEL,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(SELMAX-SELMIN)
        DO L=2,LA
         DMPVALL(L-1)=SCALE*(GI*P(L)-SELMIN)
         IDMPVALL(L-1)=NINT(DMPVALL(L-1))
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,SELMAX,SELMIN
          WRITE(1,101)IDMPVALL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO L=2,LA
           IB16VALL(L-1)=IDMPVALL(L-1)+IADJDMP
          ENDDO
          WRITE(1)TIME,SELMAX,SELMIN
          WRITE(1)IB16VALL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  U VELOCITY COMPONENT
!
      IF(ISDMPU.GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDUUU,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDUUU,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(UUUMAX-UUUMIN)
        DO K=1,KC
        DO L=2,LA
         UUUTMP=0.5*(U(L,K)+U(L+1,K))
         DMPVAL(L-1,K)=SCALE*(UUUTMP-UUUMIN)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,UUUMAX,UUUMIN
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,UUUMAX,UUUMIN
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  V VELOCITY COMPONENT
!
      IF(ISDMPU.GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDVVV,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDVVV,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(VVVMAX-VVVMIN)
        DO K=1,KC
        DO L=2,LA
         VVVTMP=0.5*(V(L,K)+V(LNC(L),K))
         DMPVAL(L-1,K)=SCALE*(VVVTMP-VVVMIN)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,VVVMAX,VVVMIN
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,VVVMAX,VVVMIN
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  W VELOCITY COMPONENT
!
      IF(ISDMPW.GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDWWW,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDWWW,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(WWWMAX-WWWMIN)
        DO K=1,KC
        DO L=2,LA
         WWWTMP=0.5*(W(L,K)+W(L,K-1))
         DMPVAL(L-1,K)=SCALE*(WWWTMP-WWWMIN)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,WWWMAX,WWWMIN
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,WWWMAX,WWWMIN
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  SALINITY
!
      IF(ISDMPT.GE.1.AND.ISTRAN(1).GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDSAL,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDSAL,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(SALMAX-SALMIN)
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*(SAL(L,K)-SALMIN)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,SALMAX,SALMIN
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,SALMAX,SALMIN
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TEMPATURE
!
      IF(ISDMPT.GE.1.AND.ISTRAN(2).GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTEM,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTEM,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(TEMMAX-TEMMIN)
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*(TEM(L,K)-TEMMIN)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,TEMMAX,TEMMIN
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,TEMMAX,TEMMIN
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  DYE
!
      IF(ISDMPT.GE.1.AND.ISTRAN(3).GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDDYE,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDDYE,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(DYEMAX-DYEMIN)
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*(DYE(L,K)-DYEMIN)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,DYEMAX,DYEMIN
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,DYEMAX,DYEMIN
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TOTAL COHESIVE SEDIMENT WATER COLUMN
!
      IF(ISDMPT.GE.1.AND.ISTRAN(6).GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDSDW,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDSDW,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(SDWMAX-SDWMIN)
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*(SEDT(L,K)-SDWMIN)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,SDWMAX,SDWMIN
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,SDWMAX,SDWMIN
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TOTAL NONCOHESIVE SEDIMENT IN WATER COLUMN
!
      IF(ISDMPT.GE.1.AND.ISTRAN(7).GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDSNW,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDSNW,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(SNWMAX-SNWMIN)
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*(SNDT(L,K)-SNWMIN)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,SNWMAX,SNWMIN
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,SNWMAX,SNWMIN
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TOTAL TOXIC CONTAMINANTS IN WATER COLUMN
!
      IF(ISDMPT.GE.1.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTWT(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTWT(NT),POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(TXWMAX(NT)-TXWMIN(NT))
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*(TOX(L,K,NT)-TXWMIN(NT))
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,TXWMAX(NT),TXWMIN(NT)
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,TXWMAX(NT),TXWMIN(NT)
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  FREE DISSOLVED TOXIC CONTAMINANTS IN WATER COLUMN
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTWF(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTWF(NT),POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(TXWMAX(NT)-TXWMIN(NT))
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*(TOX(L,K,NT)-TXWMIN(NT))
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,TXWMAX(NT),TXWMIN(NT)
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,TXWMAX(NT),TXWMIN(NT)
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
!
! **  COMPLEXED DISSOLVED TOXIC CONTAMINANTS IN WATER COLUMN
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTWC(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTWC(NT),POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(TXWMAX(NT)-TXWMIN(NT))
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*(TOX(L,K,NT)-TXWMIN(NT))
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,TXWMAX(NT),TXWMIN(NT)
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,TXWMAX(NT),TXWMIN(NT)
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!

! **  PARTICULATE TOXIC CONTAMINANT IN WATER COLUMN
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTWP(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTWP(NT),POSITION='APPEND',FORM='UNFORMATTED')
!        SCALE=100.
        SCALE=RSCALE
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SCALE*TOXPFTW(L,K,NT)
         IDMPVAL(L-1,K)=NINT(DMPVAL(L-1,K))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,R1,R0
!          WRITE(1,102)IDMPVAL
          WRITE(1,101)IDMPVAL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
!           IB08VAL(L-1,K)=IDMPVAL(L-1,K)
           IB16VAL(L-1,K)=IDMPVAL(L-1,K)+IADJDMP
          ENDDO
          ENDDO
          WRITE(1)TIME,R1,R0
!          WRITE(1)IB08VAL
          WRITE(1)IB16VAL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  TOTAL COHESIVE SEDIMENT IN BED
!
      IF(ISDMPT.GE.1.AND.ISTRAN(6).GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDSDB,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDSDB,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(SDBMAX-SDBMIN)
        DO L=2,LA
         DMPVALL(L-1)=SCALE*(SEDBT(L,KBT(L))-SDBMIN)
         IDMPVALL(L-1)=NINT(DMPVALL(L-1))
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,SDBMAX,SDBMIN
          WRITE(1,101)IDMPVALL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO L=2,LA
           IB16VALL(L-1)=IDMPVALL(L-1)+IADJDMP
          ENDDO
          WRITE(1)TIME,SDBMAX,SDBMIN
          WRITE(1)IB16VALL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TOTAL NONCOHESIVE SEDIMENT IN BED
!
      IF(ISDMPT.GE.1.AND.ISTRAN(7).GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDSNB,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDSNB,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(SNBMAX-SNBMIN)
        DO L=2,LA
         DMPVALL(L-1)=SCALE*(SNDBT(L,KBT(L))-SNBMIN)
         IDMPVALL(L-1)=NINT(DMPVALL(L-1))
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,SNBMAX,SNBMIN
          WRITE(1,101)IDMPVALL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO L=2,LA
           IB16VALL(L-1)=IDMPVALL(L-1)+IADJDMP
          ENDDO
          WRITE(1)TIME,SNBMAX,SNBMIN
          WRITE(1)IB16VALL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  THICKNESS OF SEDIMENT BED
!
      IF(ISDMPT.GE.1)THEN
      IF(ISTRAN(6).GE.1.OR.ISTRAN(7).GE.1)THEN
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDBDH,POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDBDH,POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(BDHMAX-BDHMIN+1.E-10)
        DO L=2,LA
         DMPVALL(L-1)=SCALE*(VOLBW2(L,KBT(L))-BDHMIN)
         IDMPVALL(L-1)=NINT(DMPVALL(L-1))
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,BDHMAX,BDHMIN
          WRITE(1,101)IDMPVALL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO L=2,LA
           IB16VALL(L-1)=IDMPVALL(L-1)+IADJDMP
          ENDDO
          WRITE(1)TIME,BDHMAX,BDHMIN
          WRITE(1)IB16VALL
        ENDIF
        CLOSE(1)
      ENDIF
      ENDIF
!
! **  TOTAL TOXIC CONTAMINANTS IN SEDIMENT BED
!
      IF(ISDMPT.GE.1.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTBT(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTBT(NT),POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(TXBMAX(NT)-TXBMIN(NT))
        DO L=2,LA
         DMPVALL(L-1)=SCALE*(TOXB(L,KBT(L),NT)-TXBMIN(NT))
         IDMPVALL(L-1)=NINT(DMPVALL(L-1))
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,TXBMAX(NT),TXBMIN(NT)
          WRITE(1,101)IDMPVALL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO L=2,LA
           IB16VALL(L-1)=IDMPVALL(L-1)+IADJDMP
          ENDDO
          WRITE(1)TIME,TXBMAX(NT),TXBMIN(NT)
          WRITE(1)IB16VALL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  FREE DISSOLVED TOXIC CONTAMINANTS IN SEDIMENT BED
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTBF(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTBF(NT),POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(TXBMAX(NT)-TXBMIN(NT))
        DO L=2,LA
         DMPVALL(L-1)=SCALE*(TOXB(L,KBT(L),NT)-TXBMIN(NT))
         IDMPVALL(L-1)=NINT(DMPVALL(L-1))
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,TXBMAX(NT),TXBMIN(NT)
          WRITE(1,101)IDMPVALL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO L=2,LA
           IB16VALL(L-1)=IDMPVALL(L-1)+IADJDMP
          ENDDO
          WRITE(1)TIME,TXBMAX(NT),TXBMIN(NT)
          WRITE(1)IB16VALL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  COMPLEXED DISSOLVED TOXIC CONTAMINANTS IN SEDIMENT BED
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTBC(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTBC(NT),POSITION='APPEND',FORM='UNFORMATTED')
        SCALE=RSCALE/(TXBMAX(NT)-TXBMIN(NT))
        DO L=2,LA
         DMPVALL(L-1)=SCALE*(TOXB(L,KBT(L),NT)-TXBMIN(NT))
         IDMPVALL(L-1)=NINT(DMPVALL(L-1))
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,TXBMAX(NT),TXBMIN(NT)
          WRITE(1,101)IDMPVALL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO L=2,LA
           IB16VALL(L-1)=IDMPVALL(L-1)+IADJDMP
          ENDDO
          WRITE(1)TIME,TXBMAX(NT),TXBMIN(NT)
          WRITE(1)IB16VALL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  PARTICULATE TOXIC CONTAMINANT IN SEDIMENT BED
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.1) OPEN(1,FILE=FNDTBP(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.2)OPEN(1,FILE=FNDTBP(NT),POSITION='APPEND',FORM='UNFORMATTED')
!        SCALE=100.
        SCALE=RSCALE
        DO L=2,LA
         DMPVALL(L-1)=SCALE*TOXPFTB(L,KB,NT)
         IDMPVALL(L-1)=NINT(DMPVALL(L-1))
        ENDDO
        IF(ISDUMP.EQ.1)THEN
          WRITE(1,*)TIME,R1,R0
!          WRITE(1,102)IDMPVALL
          WRITE(1,101)IDMPVALL
        ENDIF
        IF(ISDUMP.EQ.2)THEN
          DO L=2,LA
!           IB08VALL(L-1)=IDMPVALL(L-1)
           IB16VALL(L-1)=IDMPVALL(L-1)+IADJDMP
          ENDDO
          WRITE(1)TIME,R1,R0
!          WRITE(1)IB08VALL
          WRITE(1)IB16VALL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
      ENDIF
!
!**********************************************************************C
!
! **  IF(ISDUMP EQUAL 3 OR 4, WRITE FLOATING POINT
! **  DUMP FILES
!
      IF(ISDUMP.GE.3)THEN
!
! **  WATER SURFACE ELEVATION
!
      IF(ISDMPP.GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDSEL,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDSEL,POSITION='APPEND',FORM='UNFORMATTED')
        DO L=2,LA
         DMPVALL(L-1)=GI*P(L)
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVALL
!          WRITE(1,111)(DMPVALL(L),L=1,LA-1)
          DO L=1,LA-1
            WRITE(1,111)DMPVALL(L),HP(L+1),BELV(L+1),HBEDA(L+1)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVALL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  U VELOCITY COMPONENT
!
      IF(ISDMPU.GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDUUU,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDUUU,POSITION='APPEND',FORM='UNFORMATTED')
        IF(ISDMPU.EQ.1)THEN
          DO K=1,KC
          DO L=2,LA
            DMPVAL(L-1,K)=0.5*(U(L,K)+U(L+1,K))
          ENDDO
          ENDDO
        ENDIF
        IF(ISDMPU.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
            DMPVAL(L-1,K)=DZC(K)*UHDY2(L,K)
          ENDDO
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
!          IF(ISDMPU.EQ.1)THEN
            DO L=1,LA-1
              WRITE(1,111)(DMPVAL(L,K), K=1,KC)
            ENDDO
!	    ELSE
!            DO L=2,LA
!              WRITE(1,111)(U(L,K), K=1,KC)
!            ENDDO
!	    ENDIF
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  V VELOCITY COMPONENT
!
      IF(ISDMPU.GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDVVV,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDVVV,POSITION='APPEND',FORM='UNFORMATTED')
        IF(ISDMPU.EQ.1)THEN
          DO K=1,KC
          DO L=2,LA
            DMPVAL(L-1,K)=0.5*(V(L,K)+V(LNC(L),K))
          ENDDO
          ENDDO
        ENDIF
        IF(ISDMPU.EQ.2)THEN
          DO K=1,KC
          DO L=2,LA
            DMPVAL(L-1,K)=DZC(K)*VHDX2(L,K)
          ENDDO
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
!          IF(ISDMPU.EQ.1)THEN
            DO L=1,LA-1
              WRITE(1,111)(DMPVAL(L,K), K=1,KC)
            ENDDO
!	    ELSE
!            DO L=2,LA
!              WRITE(1,111)(V(L,K), K=1,KC)
!            ENDDO
!	    ENDIF
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  W VELOCITY COMPONENT
!
      IF(ISDMPW.GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDWWW,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDWWW,POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=0.5*(W(L,K)+W(L,K-1))
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          IF(ISDMPW.EQ.1)THEN
            DO L=1,LA-1
              WRITE(1,111)(DMPVAL(L,K), K=1,KC)
            ENDDO
	    ELSE
            DO L=2,LA
              WRITE(1,111)(W(L,K), K=1,KS)
            ENDDO
	    ENDIF
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  SALINITY
!
      IF(ISDMPT.GE.1.AND.ISTRAN(1).GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDSAL,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDSAL,POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SAL(L,K)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TEMPERATURE
!
      IF(ISDMPT.GE.1.AND.ISTRAN(2).GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTEM,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTEM,POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=TEM(L,K)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  DYE
!
      IF(ISDMPT.GE.1.AND.ISTRAN(3).GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDDYE,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDDYE,POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=DYE(L,K)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TOTAL COHESIVE SEDIMENT IN WATER COLUMN
!
      IF(ISDMPT.GE.1.AND.ISTRAN(6).GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDSDW,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDSDW,POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SEDT(L,K)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TOTAL NONCOHESIVE SEDIMENT IN WATER COLUMN
!
      IF(ISDMPT.GE.1.AND.ISTRAN(7).GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDSNW,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDSNW,POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=SNDT(L,K)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TOTAL TOXIC CONTAMINANTS IN WATER COLUMN
!
      IF(ISDMPT.GE.1.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTWT(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTWT(NT),POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=TOX(L,K,NT)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  FREE DISSOLVED TOXIC CONTAMINANTS IN WATER COLUMN
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTWF(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTWF(NT),POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=TOXFDFB(L,K,NT)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  COMPLEXED DISSOLVED TOXIC CONTAMINANTS IN WATER COLUMN
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTWC(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTWC(NT),POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=TOXCDFB(L,K,NT)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  PARTICULATE TOXIC CONTAMINANT IN WATER COLUMN
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTWP(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTWP(NT),POSITION='APPEND',FORM='UNFORMATTED')
        DO K=1,KC
        DO L=2,LA
         DMPVAL(L-1,K)=TOXPFTW(L,K,NT)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
!          WRITE(1,111)DMPVAL
          DO L=1,LA-1
            WRITE(1,111)(DMPVAL(L,K), K=1,KC)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVAL
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  TOTAL COHESIVE SEDIMENT IN BED
!
      IF(ISDMPT.GE.1.AND.ISTRAN(6).GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDSDB,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDSDB,POSITION='APPEND',FORM='UNFORMATTED')
!        DO L=2,LA
!         DMPVALL(L-1)=SEDBT(L,KBT(L))
!        ENDDO
        DO K=1,KB
        DO L=2,LA
         DMPVALB(L-1,K)=SEDBT(L,K)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
          DO L=1,LA-1
            WRITE(1,111)(DMPVALB(L,K), K=1,KB)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVALB
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  TOTAL NONCOHESIVE SEDIMENT IN BED
!
      IF(ISDMPT.GE.1.AND.ISTRAN(7).GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDSNB,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDSNB,POSITION='APPEND',FORM='UNFORMATTED')
!        DO L=2,LA
!         DMPVALL(L-1)=SNDBT(L,KBT(L))
!        ENDDO
        DO K=1,KB
        DO L=2,LA
         DMPVALB(L-1,K)=SNDBT(L,K)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
          DO L=1,LA-1
            WRITE(1,111)(DMPVALB(L,K), K=1,KB)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVALB
        ENDIF
        CLOSE(1)
      ENDIF
!
! **  THICKNESS OF SEDIMENT BED
!
      IF(ISDMPT.GE.1)THEN
      IF(ISTRAN(6).GE.1.OR.ISTRAN(7).GE.1)THEN
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDBDH,POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDBDH,POSITION='APPEND',FORM='UNFORMATTED')
!        DO L=2,LA
!         DMPVALL(L-1)=VOLBW2(L,KB)
!        ENDDO
        DO K=1,KB
        DO L=2,LA
         DMPVALB(L-1,K)=HBED(L,K)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
          DO L=1,LA-1
            WRITE(1,111)(DMPVALB(L,K), K=1,KB)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVALB
        ENDIF
        CLOSE(1)
      ENDIF
      ENDIF
!
! **  TOTAL TOXIC CONTAMINANTS IN SEDIMENT BED
!
      IF(ISDMPT.GE.1.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTBT(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTBT(NT),POSITION='APPEND',FORM='UNFORMATTED')
!        DO L=2,LA
!         DMPVALL(L-1)=TOXB(L,KB,NT)
!        ENDDO
        DO K=1,KB
        DO L=2,LA
         DMPVALB(L-1,K)=TOXB(L,K,NT)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
          DO L=1,LA-1
            WRITE(1,111)(DMPVALB(L,K), K=1,KB)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVALB
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  FREE DISSOLVED TOXIC CONTAMINANTS IN SEDIMENT BED
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTBF(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTBF(NT),POSITION='APPEND',FORM='UNFORMATTED')
!        DO L=2,LA
!         DMPVALL(L-1)=TOXB(L,KB,NT)
!        ENDDO
        DO K=1,KB
        DO L=2,LA
         DMPVALB(L-1,K)=TOXFDFB(L,K,NT)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
          DO L=1,LA-1
            WRITE(1,111)(DMPVALB(L,K), K=1,KB)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVALB
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  COMPLEXED DISSOLVED TOXIC CONTAMINANTS IN SEDIMENT BED
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTBC(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTBC(NT),POSITION='APPEND',FORM='UNFORMATTED')
!        DO L=2,LA
!         DMPVALL(L-1)=TOXB(L,KB,NT)
!        ENDDO
        DO K=1,KB
        DO L=2,LA
         DMPVALB(L-1,K)=TOXCDFB(L,K,NT)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
          DO L=1,LA-1
            WRITE(1,111)(DMPVALB(L,K), K=1,KB)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVALB
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
! **  PARTICULATE TOXIC CONTAMINANT IN SEDIMENT BED
!
      IF(ISDMPT.GE.2.AND.ISTRAN(5).GE.1)THEN
      DO NT=1,NTOX
        IF(ISDUMP.EQ.3) OPEN(1,FILE=FNDTBP(NT),POSITION='APPEND')
        IF(ISDUMP.EQ.4)OPEN(1,FILE=FNDTBP(NT),POSITION='APPEND',FORM='UNFORMATTED')
!        DO L=2,LA
!         DMPVALL(L-1)=SCALE*TOXPFTB(L,KB,NT)
!        ENDDO
        DO K=1,KB
        DO L=2,LA
         DMPVALB(L-1,K)=TOXPFTB(L,K,NT)
        ENDDO
        ENDDO
        IF(ISDUMP.EQ.3)THEN
          WRITE(1,*)TIME
          DO L=1,LA-1
            WRITE(1,111)(DMPVALB(L,K), K=1,KB)
          ENDDO
        ENDIF
        IF(ISDUMP.EQ.4)THEN
          WRITE(1)TIME
          WRITE(1)DMPVALB
        ENDIF
        CLOSE(1)
      ENDDO
      ENDIF
!
      ENDIF
!
!**********************************************************************C
!
! **  CHECK BY READING BINARY FILES
!
!      IF(ISDUMP.EQ.2)THEN
!
!      OPEN(2,FILE='DUMP.CHK')
!      CLOSE(2,STATUS='DELETE')
!      OPEN(2,FILE='DUMP.CHK')
!
!      IF(ISDMPT.GE.1.AND.ISTRAN(5).GE.1)THEN
!        OPEN(1,FILE=FNDTPB(1),FORM='UNFORMATTED')
!        READ(1)TIME,RMAX,RMIN
!        READ(1)IB08VALL
!        CLOSE(1)
!        DO L=1,LC-2
!         DMPVALL(L)=FLOAT(IB08VALL(L))/100.
!        ENDDO
!        WRITE(2,201)
!        WRITE(2,205)TIME,RMAX,RMIN
!        WRITE(2,205)DMPVALL
!      ENDIF
!
!      IF(ISDMPT.GE.1.AND.ISTRAN(5).GE.1)THEN
!        OPEN(1,FILE=FNDTPW(1),FORM='UNFORMATTED')
!        READ(1)TIME,RMAX,RMIN
!        READ(1)IB08VAL
!        CLOSE(1)
!        DO K=1,KC
!        DO L=1,LC-2
!         DMPVAL(L,K)=FLOAT(IB08VAL(L,K))/100.
!        ENDDO
!        ENDDO
!        WRITE(2,202)
!        WRITE(2,205)TIME,RMAX,RMIN
!        WRITE(2,205)DMPVAL
!      ENDIF
!
!      IF(ISDMPP.GE.1)THEN
!        OPEN(1,FILE=FNDSEL,FORM='UNFORMATTED')
!        READ(1)TIME,SELMAX,SELMIN
!        SELMAX=SELMAX/GI
!        SELMIN=SELMIN/GI
!        READ(1)IB16VALL
!        CLOSE(1)
!        DO L=1,LC-2
!         DMPVALL(L)=FLOAT(IB16VALL(L))
!         DMPVALL(L)=DMPVALL(L)-FLOAT(IADJDMP)
!        ENDDO
!        TMPVAL=(SELMAX-SELMIN)/RSCALE
!        DO L=1,LC-2
!         DMPVALL(L)=TMPVAL*DMPVALL(L)+SELMIN
!        ENDDO
!        WRITE(2,203)
!        WRITE(2,205)TIME,SELMAX,SELMIN
!        WRITE(2,205)DMPVALL
!      ENDIF
!
!      IF(ISDMPT.GE.1.AND.ISTRAN(1).GE.1)THEN
!        OPEN(1,FILE=FNDSAL,FORM='UNFORMATTED')
!        READ(1)TIME,SALMAX,SALMIN
!        READ(1)IB16VAL
!        CLOSE(1)
!        DO K=1,KC
!        DO L=1,LC-2
!         DMPVAL(L,K)=FLOAT(IB16VAL(L,K))
!         DMPVAL(L,K)=DMPVAL(L,K)-FLOAT(IADJDMP)
!        ENDDO
!        ENDDO
!        TMPVAL=(SALMAX-SALMIN)/RSCALE
!        DO K=1,KC
!        DO L=1,LC-2
!         DMPVAL(L,K)=TMPVAL*DMPVAL(L,K)+SALMIN
!        ENDDO
!        ENDDO
!        WRITE(2,204)
!        WRITE(2,205)TIME,SALMAX,SALMIN
!        WRITE(2,205)DMPVAL
!      ENDIF
!
!      CLOSE(2)
!
!      ENDIF
!
!**********************************************************************C
!
  100 FORMAT(A80)
  101 FORMAT(8I6)
  102 FORMAT(8I4)
!  111 FORMAT(8E14.6)
!  111 FORMAT(10E12.4)
  111 FORMAT(25E14.6)
  201 FORMAT(//,' CHECK 2D  8 BIT VARIABLE',/)
  202 FORMAT(//,' CHECK 3D  8 BIT VARIABLE',/)
  203 FORMAT(//,' CHECK 2D 16 BIT VARIABLE',/)
  204 FORMAT(//,' CHECK 3D 16 BIT VARIABLE',/)
  205 FORMAT(8F8.2)
!
!**********************************************************************C
!
      RETURN
      END